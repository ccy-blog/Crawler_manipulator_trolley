# 履带机械臂小车

使用芯片：STM32F103

蓝牙模块：DXBT18

用到的模块：LED灯、蜂鸣器、定时器、舵机、电机、PS2无线手柄、串口



## 各模块实现

### 1. LED灯

使用引脚 **PB14**，低电平亮



### 2. 蜂鸣器

使用引脚 **PB13**，低电平响



### 3. 定时器

使用通用定时器 **TIM2** 控制舵机的输入高电平时间来控制舵机的旋转角度。

使用通用定时器 **TIM3、TIM4** 的输出比较模式控制电机的占空比来控制电机的旋转速度。



### 4. 舵机

舵机的控制一般需要一个20ms左右的时基脉冲，该脉冲的高电平部分一般为0.5ms-2.5ms范围，所以舵机一个周期最小为 2.5ms，最多使用 8 个舵机，20ms / 2.5ms = 8。

舵机的旋转角度与高电平的时间关系为：

 * 0.5ms————-0度；

 * 1.0ms————45度；

 * 1.5ms————90度；

 * 2.0ms———–135度；

 * 2.5ms———–180度；



使用的引脚：**舵机1（PA8）、舵机2（PA15）、舵机3（PB3）、舵机4（PB4）、舵机5（PB5）、舵机6（PB15）**

舵机的方向：**使用（PWM）定时器控制输入高电平时间，达到控制舵机的旋转角度**

舵机的默认方向：**最大脉冲定义为 2505（#define SERVO_PCM_MAX 2505），初始值设置为 1500，即（默认）初始方向为 90° 位置**



### 5. 电机

TIM 使用引脚：**PB0、PB1、PB8、PB9，设置为 复用推挽输出模式，输出 TIM3、TIM4 的 CH3、CH4 的 PWM 脉冲波形**，

电机的速度：**使用（PWM）定时器控制占空比，达到控制电机机的旋转速度**



### 6. PS2 无线手柄

PS2 控制器使用引脚：**PA11（时钟）、PA12（CS）、PA13（发送）、PA14（接收），PA14 配置为 下拉输入**

**PS2 控制器向手柄发送指令获取数据并保存，进而对小车进行控制。**

详细参考： [ps2解码通讯手册V1.3.doc](Doc/ps2解码通讯手册V1.3.doc)



### 7. 串口

蓝牙模块使用串口引脚：**PA9（TXD）、PA10（RXD）**

WIFI模块使用串口引脚：**PA2（TXD）、PA3（RXD）**

**TXD 设置为 复用推挽输出模式，RXD 设置为 浮空输入模式**

**串口通过中断接收从其它模块发过来的数据并保存，进而对小车进行控制。**

